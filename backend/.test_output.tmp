[1m============================= test session starts ==============================[0m
platform darwin -- Python 3.11.13, pytest-7.4.3, pluggy-1.6.0 -- /Users/sameer/Desktop/Code/SideProjects/economic-dashboard/backend/.venv/bin/python3.11
cachedir: .pytest_cache
rootdir: /Users/sameer/Desktop/Code/SideProjects/economic-dashboard/backend
configfile: pytest.ini
plugins: timeout-2.2.0, anyio-4.11.0, cov-4.1.0, asyncio-0.21.1
timeout: 60.0s
timeout method: signal
timeout func_only: False
asyncio: mode=Mode.AUTO
[1mcollecting ... [0mcollected 26 items

test_api.py::TestHealth::test_root_endpoint [32mPASSED[0m[32m                       [  3%][0m
test_api.py::TestHealth::test_health_endpoint [32mPASSED[0m[32m                     [  7%][0m
test_api.py::TestHealth::test_liveness_endpoint [32mPASSED[0m[32m                   [ 11%][0m
test_api.py::TestHealth::test_readiness_endpoint [32mPASSED[0m[32m                  [ 15%][0m
test_api.py::TestHealth::test_ping_endpoint [32mPASSED[0m[32m                       [ 19%][0m
test_api.py::TestAuthentication::test_user_registration_success [31mFAILED[0m[31m   [ 23%][0m
test_api.py::TestAuthentication::test_user_registration_duplicate_email [31mERROR[0m[31m [ 26%][0m
test_api.py::TestAuthentication::test_user_registration_weak_password [31mFAILED[0m[31m [ 30%][0m
test_api.py::TestAuthentication::test_user_login_success [31mERROR[0m[31m           [ 34%][0m
test_api.py::TestAuthentication::test_user_login_invalid_credentials [31mERROR[0m[31m [ 38%][0m
test_api.py::TestAuthentication::test_user_login_nonexistent_user [32mPASSED[0m[31m [ 42%][0m
test_api.py::TestAuthentication::test_get_current_user_with_valid_token [31mERROR[0m[31m [ 46%][0m
test_api.py::TestAuthentication::test_get_current_user_without_token [31mFAILED[0m[31m [ 50%][0m
test_api.py::TestAuthentication::test_get_current_user_with_invalid_token [32mPASSED[0m[31m [ 53%][0m
test_api.py::TestAuthentication::test_refresh_token [31mERROR[0m[31m                [ 57%][0m
test_api.py::TestAuthentication::test_logout [31mERROR[0m[31m                       [ 61%][0m
test_api.py::TestFredData::test_get_current_data [32mPASSED[0m[31m                  [ 65%][0m
test_api.py::TestFredData::test_get_historical_data_dff [32mPASSED[0m[31m           [ 69%][0m
test_api.py::TestFredData::test_get_historical_data_with_date_range [32mPASSED[0m[31m [ 73%][0m
test_api.py::TestFredData::test_get_historical_data_invalid_series [32mPASSED[0m[31m [ 76%][0m
test_api.py::TestFredData::test_refresh_data_requires_auth [31mFAILED[0m[31m        [ 80%][0m
test_api.py::TestFredData::test_refresh_data_authenticated [31mERROR[0m[31m         [ 84%][0m
test_api.py::TestCaching::test_caching_behavior [32mPASSED[0m[31m                   [ 88%][0m
test_api.py::TestCaching::test_cache_invalidation [31mERROR[0m[31m                  [ 92%][0m
test_api.py::TestIntegration::test_full_user_workflow [31mFAILED[0m[31m             [ 96%][0m
test_api.py::TestIntegration::test_database_persistence [32mPASSED[0m[31m           [100%][0m

==================================== ERRORS ====================================
[31m[1m_ ERROR at setup of TestAuthentication.test_user_registration_duplicate_email __[0m
[1m[31mtest_api.py[0m:93: in registered_user
    pytest.fail([33mf[39;49;00m[33m"[39;49;00m[33mUser registration failed: [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m - [39;49;00m[33m{[39;49;00mresponse.text[33m}[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
[1m[31mE   Failed: User registration failed: 500 - {"detail":"Error creating user account"}[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/auth/register "HTTP/1.1 500 Internal Server Error"
[31m[1m_________ ERROR at setup of TestAuthentication.test_user_login_success _________[0m
[1m[31mtest_api.py[0m:93: in registered_user
    pytest.fail([33mf[39;49;00m[33m"[39;49;00m[33mUser registration failed: [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m - [39;49;00m[33m{[39;49;00mresponse.text[33m}[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
[1m[31mE   Failed: User registration failed: 500 - {"detail":"Error creating user account"}[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/auth/register "HTTP/1.1 500 Internal Server Error"
[31m[1m___ ERROR at setup of TestAuthentication.test_user_login_invalid_credentials ___[0m
[1m[31mtest_api.py[0m:93: in registered_user
    pytest.fail([33mf[39;49;00m[33m"[39;49;00m[33mUser registration failed: [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m - [39;49;00m[33m{[39;49;00mresponse.text[33m}[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
[1m[31mE   Failed: User registration failed: 500 - {"detail":"Error creating user account"}[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/auth/register "HTTP/1.1 500 Internal Server Error"
[31m[1m_ ERROR at setup of TestAuthentication.test_get_current_user_with_valid_token __[0m
[1m[31mtest_api.py[0m:93: in registered_user
    pytest.fail([33mf[39;49;00m[33m"[39;49;00m[33mUser registration failed: [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m - [39;49;00m[33m{[39;49;00mresponse.text[33m}[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
[1m[31mE   Failed: User registration failed: 500 - {"detail":"Error creating user account"}[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/auth/register "HTTP/1.1 500 Internal Server Error"
[31m[1m___________ ERROR at setup of TestAuthentication.test_refresh_token ____________[0m
[1m[31mtest_api.py[0m:93: in registered_user
    pytest.fail([33mf[39;49;00m[33m"[39;49;00m[33mUser registration failed: [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m - [39;49;00m[33m{[39;49;00mresponse.text[33m}[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
[1m[31mE   Failed: User registration failed: 500 - {"detail":"Error creating user account"}[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/auth/register "HTTP/1.1 500 Internal Server Error"
[31m[1m_______________ ERROR at setup of TestAuthentication.test_logout _______________[0m
[1m[31mtest_api.py[0m:93: in registered_user
    pytest.fail([33mf[39;49;00m[33m"[39;49;00m[33mUser registration failed: [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m - [39;49;00m[33m{[39;49;00mresponse.text[33m}[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
[1m[31mE   Failed: User registration failed: 500 - {"detail":"Error creating user account"}[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/auth/register "HTTP/1.1 500 Internal Server Error"
[31m[1m________ ERROR at setup of TestFredData.test_refresh_data_authenticated ________[0m
[1m[31mtest_api.py[0m:93: in registered_user
    pytest.fail([33mf[39;49;00m[33m"[39;49;00m[33mUser registration failed: [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m - [39;49;00m[33m{[39;49;00mresponse.text[33m}[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
[1m[31mE   Failed: User registration failed: 500 - {"detail":"Error creating user account"}[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/auth/register "HTTP/1.1 500 Internal Server Error"
[31m[1m____________ ERROR at setup of TestCaching.test_cache_invalidation _____________[0m
[1m[31mtest_api.py[0m:93: in registered_user
    pytest.fail([33mf[39;49;00m[33m"[39;49;00m[33mUser registration failed: [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m - [39;49;00m[33m{[39;49;00mresponse.text[33m}[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
[1m[31mE   Failed: User registration failed: 500 - {"detail":"Error creating user account"}[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/auth/register "HTTP/1.1 500 Internal Server Error"
=================================== FAILURES ===================================
[31m[1m______________ TestAuthentication.test_user_registration_success _______________[0m
[1m[31mtest_api.py[0m:248: in test_user_registration_success
    [94massert[39;49;00m response.status_code == [94m201[39;49;00m, [33mf[39;49;00m[33m"[39;49;00m[33mExpected 201, got [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: Expected 201, got 500[0m
[1m[31mE   assert 500 == 201[0m
[1m[31mE    +  where 500 = <Response [500 Internal Server Error]>.status_code[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/auth/register "HTTP/1.1 500 Internal Server Error"
[31m[1m___________ TestAuthentication.test_user_registration_weak_password ____________[0m
[1m[31mtest_api.py[0m:283: in test_user_registration_weak_password
    [94massert[39;49;00m response.status_code == [94m400[39;49;00m, [33mf[39;49;00m[33m"[39;49;00m[33mExpected 400 for weak password, got [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: Expected 400 for weak password, got 422[0m
[1m[31mE   assert 422 == 400[0m
[1m[31mE    +  where 422 = <Response [422 Unprocessable Entity]>.status_code[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/auth/register "HTTP/1.1 422 Unprocessable Entity"
[31m[1m____________ TestAuthentication.test_get_current_user_without_token ____________[0m
[1m[31mtest_api.py[0m:347: in test_get_current_user_without_token
    [94massert[39;49;00m response.status_code == [94m401[39;49;00m, [33mf[39;49;00m[33m"[39;49;00m[33mExpected 401 without token, got [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: Expected 401 without token, got 403[0m
[1m[31mE   assert 403 == 401[0m
[1m[31mE    +  where 403 = <Response [403 Forbidden]>.status_code[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: GET https://economic-dashboard-production.up.railway.app/auth/me "HTTP/1.1 403 Forbidden"
[31m[1m_________________ TestFredData.test_refresh_data_requires_auth _________________[0m
[1m[31mtest_api.py[0m:453: in test_refresh_data_requires_auth
    [94massert[39;49;00m response.status_code == [94m401[39;49;00m, [33mf[39;49;00m[33m"[39;49;00m[33mExpected 401 without auth, got [39;49;00m[33m{[39;49;00mresponse.status_code[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: Expected 401 without auth, got 403[0m
[1m[31mE   assert 403 == 401[0m
[1m[31mE    +  where 403 = <Response [403 Forbidden]>.status_code[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/data/refresh "HTTP/1.1 403 Forbidden"
[31m[1m___________________ TestIntegration.test_full_user_workflow ____________________[0m
[1m[31mtest_api.py[0m:539: in test_full_user_workflow
    [94massert[39;49;00m register_response.status_code == [94m201[39;49;00m, [33m"[39;49;00m[33mRegistration should succeed[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: Registration should succeed[0m
[1m[31mE   assert 500 == 201[0m
[1m[31mE    +  where 500 = <Response [500 Internal Server Error]>.status_code[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1758 HTTP Request: POST https://economic-dashboard-production.up.railway.app/auth/register "HTTP/1.1 500 Internal Server Error"
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m test_api.py::[1mTestAuthentication::test_user_registration_success[0m - AssertionError: Expected 201, got 500
[31mFAILED[0m test_api.py::[1mTestAuthentication::test_user_registration_weak_password[0m - AssertionError: Expected 400 for weak password, got 422
[31mFAILED[0m test_api.py::[1mTestAuthentication::test_get_current_user_without_token[0m - AssertionError: Expected 401 without token, got 403
[31mFAILED[0m test_api.py::[1mTestFredData::test_refresh_data_requires_auth[0m - AssertionError: Expected 401 without auth, got 403
[31mFAILED[0m test_api.py::[1mTestIntegration::test_full_user_workflow[0m - AssertionError: Registration should succeed
[31mERROR[0m test_api.py::[1mTestAuthentication::test_user_registration_duplicate_email[0m - Failed: User registration failed: 500 - {"detail":"Error creating user acco...
[31mERROR[0m test_api.py::[1mTestAuthentication::test_user_login_success[0m - Failed: User registration failed: 500 - {"detail":"Error creating user acco...
[31mERROR[0m test_api.py::[1mTestAuthentication::test_user_login_invalid_credentials[0m - Failed: User registration failed: 500 - {"detail":"Error creating user acco...
[31mERROR[0m test_api.py::[1mTestAuthentication::test_get_current_user_with_valid_token[0m - Failed: User registration failed: 500 - {"detail":"Error creating user acco...
[31mERROR[0m test_api.py::[1mTestAuthentication::test_refresh_token[0m - Failed: User registration failed: 500 - {"detail":"Error creating user acco...
[31mERROR[0m test_api.py::[1mTestAuthentication::test_logout[0m - Failed: User registration failed: 500 - {"detail":"Error creating user acco...
[31mERROR[0m test_api.py::[1mTestFredData::test_refresh_data_authenticated[0m - Failed: User registration failed: 500 - {"detail":"Error creating user acco...
[31mERROR[0m test_api.py::[1mTestCaching::test_cache_invalidation[0m - Failed: User registration failed: 500 - {"detail":"Error creating user acco...
[31m==================== [31m[1m5 failed[0m, [32m13 passed[0m, [31m[1m8 errors[0m[31m in 7.48s[0m[31m ====================[0m
